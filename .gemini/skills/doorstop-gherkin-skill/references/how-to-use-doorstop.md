### Doorstop CLI コマンド仕様書

#### 1. ドキュメント・プロジェクト管理

仕様書の階層構造（ドキュメントツリー）を構築・整理するためのコマンド群です。

* **`doorstop create <prefix> <path>`**
要件をまとめる新しいドキュメント（ディレクトリ）を作成します。`--parent <parent_prefix>` オプションを付与することで、既存のドキュメントを親として指定し、階層構造を持たせることができます。
* **`doorstop reorder <prefix>`**
ドキュメント内の全アイテムの表示順序（`level` 属性）を再計算し、きれいにナンバリングし直します。

#### 2. アイテム（要件・テストケース）の操作

個別の仕様項目を作成、編集、削除するためのコマンド群です。

* **`doorstop add <prefix>`**
指定したドキュメントに新しいアイテムを追加し、一意のID（例：`SRD001.yml`）を持つファイルを生成します。
* **`doorstop edit <item>`**
指定したアイテムを環境変数に設定されたデフォルトエディタで開き、テキストやカスタム属性を直接編集します。
* **`doorstop remove <item>`**
指定したアイテムをドキュメントツリーから完全に削除します。

#### 3. リンク管理（トレーサビリティ）

アイテム間の依存関係や追跡可能性（トレーサビリティ）を定義するためのコマンド群です。

* **`doorstop link <child_item> <parent_item>`**
子アイテムから親アイテムへのリンク関係を構築します。仕様の依存関係が循環（ループ）するようなリンクの構築はシステムによってブロックされます。
* **`doorstop unlink <child_item> <parent_item>`**
アイテム間に設定されている既存のリンクを解除します。

#### 4. 検証とステータス管理

仕様の変更漏れを防ぎ、プロジェクト全体の健全性を保つためのコマンド群です。

* **`doorstop` (引数なし)**
ドキュメントツリー全体の整合性チェック（バリデーション）を実行します。リンク漏れや、後述の「未レビュー」「Suspect」状態のアイテムが存在する場合は警告が出力されます。
* **`doorstop review <item>`**
新規作成または編集したアイテムを「レビュー完了（確認済み）」としてシステムに登録し、アイテムの最新ハッシュ値を記録します。
* **`doorstop clear <item>`**
親アイテムの仕様が変更されたことに伴い、子アイテムに自動付与された「Suspect（疑わしいリンク）」の警告フラグをクリアし、現在の状態で整合性がとれていることを承認します。

#### 5. 入出力・レポート生成

外部データとの連携や、仕様書の公開を行うためのコマンド群です。

* **`doorstop publish <prefix|all> <path>`**
仕様書やトレーサビリティ・マトリックスを指定したディレクトリに出力します。対応する拡張子は、HTML（デフォルト）、Markdown（`.md`）、Text（`.txt`）、LaTeX（`.tex`）です。
* **`doorstop import <prefix> <file>`**
CSVなどの外部ファイルから要件データを一括で読み込み、指定したドキュメントにアイテムとして追加します。
* **`doorstop export <prefix> <file>`**
ドキュメント内のアイテム一覧を、スプレッドシート等で扱えるようCSVなどの形式で外部ファイルに出力します。
