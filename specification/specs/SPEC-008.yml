active: true
derived: false
header: |
  動的プレフィックス検知とマルチインデックス生成
level: 8.0
links:
- REQ-007: null
normative: true
ref: ''
reviewed: 4apXFTOPMCjuqnCX_nxUXidFefqeFx3XGi7KcjucDds=
status: implemented
testable: false
text: |
  ## 概要
  `build` コマンドにおける動的なドキュメント検知と、それに基づいたマルチインデックス生成
  のロジックを定義する。

  ## 詳細仕様

  ### ドキュメント検知ロジック
  - `doorstop.build()` によって構築されたツリーを走査し、登録されているすべての `Document`
    のプレフィックス（`prefix` 属性）を抽出する。

  ### Gherkinタグの収集
  - `get_tag_map` は、検知されたすべてのプレフィックスのセットを対象に .feature ファイルを走査し、
    いずれかのプレフィックスで始まるタグ（例: `@AUTH-001`, `@PAY-005`）をすべて収集する。

  ### インデックスページの生成
  - 検知された各プレフィックスに対し、`{prefix}.md`（小文字）というファイル名の一覧ページを生成する。
  - 一覧ページのテーブルは、特定プレフィックスに依存しない汎用的な形式
    （ID | タイトル | 親 | 子 | 兄弟 | カバレッジ | 実装状況 | 状態）を採用する。

  ### サイト統合
  - `docs/index.md` は、検知されたすべてのプレフィックスのリストと、Doorstopで定義された
    ドキュメント階層を正確に反映したツリーを表示する。
  - `mkdocs.yml` のナビゲーションセクションに、検知されたすべてのドキュメントへのリンク
    （例: `AUTH一覧: auth.md`）を自動的に追加する。
