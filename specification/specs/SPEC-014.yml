active: true
created_at: '2026-02-26'
derived: false
header: |
  feature MDページのバックリンク生成
level: 3.14
links:
- REQ-003: Rb8ehO6TwgTYIqN3kXtu3nzq6LWHqvsE0-d2B9HrUWM=
normative: true
ref: ''
reviewed: Y8BNVjASsF43b1sz2z_ZZPVGYJvQS7UC0Jzg0j2H4nc=
status: implemented
testable: true
text: |
  ## 概要
  `build` コマンドが生成する `.feature` → Markdown 変換ページの冒頭に、
  そのfeatureを参照しているDoorstopアイテム（SPEC, REQ等）への
  バックリンクセクションを自動生成する。

  ## 背景・動機
  Gherkinのfeatureファイルにはタグ（`@SPEC-003` 等）で仕様IDが紐付けられているが、
  生成されたfeature MDページからは元のDoorstopアイテムへ戻る手段がなかった。
  双方向のナビゲーションを提供することで、仕様書としての利便性を向上させる。

  ## 詳細仕様

  ### バックリンクマップの構築
  - `tag_map`（`spec_id → [ScenarioInfo]`）を逆引きし、
    `feature_path → [uid, ...]` のマッピング（`feature_backlink_map`）を生成する
  - 同一featureを参照する複数UIDは重複排除の上、ソートして格納する

  ### Markdown出力
  - feature MDの冒頭（タグ行の直下）に「関連アイテム」行を追記する
  - フォーマット: `**関連アイテム**: [UID](../items/UID.md) / [UID2](../items/UID2.md)`
  - 関連アイテムが存在しない場合は当該行を出力しない

  ## 受け入れ基準
  - `@SPEC-003` タグを持つfeatureのMDページに `[SPEC-003](../items/SPEC-003.md)` リンクが含まれること
  - 複数アイテムが同一featureを参照する場合、全UIDのリンクが「/」区切りで表示されること
  - どのアイテムにも参照されていないfeatureにはバックリンク行が表示されないこと
updated_at: '2026-02-26'
